# Malware Analysis (AnyRun::cource)

This is an markdown file just to follow up with the any run cource

The tools we will be using are as under

![tools](./img/tools.png)

What is Malware Analysis?
Let's dive into the world of malware analysis with an introductory discussion about what it is and how it can be used.

In This Lesson

- ### Definition of malware analysis
- ### The benefits of malware analysis
- ### Types of malware analysis
- ### Stages of malware analysis

---

<br>
<br>

# Definition of Malware Analysis

Malware analysis involves examining a potential malware sample to understand its type, functions, and the risks it poses.

Researchers conduct this analysis to gain crucial threat intelligence, respond to cybersecurity incidents, and enhance a company’s defenses.

### Benefits of Malware Analysis

Imagine a corporate computer infected with new malware, like ransomware. If the malware spreads across the network, it could lead to significant financial losses or loss of vital data.

Security researchers aim to

- ### identify the type of malware
- ### understand its operation
- ### assess the potential damage
- ### detect network and host indicators

The analysis helps answer key questions:

- ## What does the malware do?
- ## How can it be detected on the network?
- ## How to assess and minimize the damage?
- ## How to prevent future attacks?

In some cases, you might need additional information from external sources. For instance, extracting network and host indicators and searching them in external systems can provide more indicators of compromise and insights into the malware’s behavior that might not be evident from your sample alone.

---

<br>
<br>

# Types of Malware Analysis

- ### Static analysis

  Static analysis examines a suspicious file without executing it, offering insights that help create static signatures. For example, by analyzing code, researchers might find IP addresses and URLs pointing to a malware control server. Static analysis can also identify the file type and calculate a hash sum, useful for signature creation. However, its limitations include the risk of being misled by obfuscated code, a common technique in advanced malware.

- ### Dynamic analysis

  Dynamic analysis involves running malware samples in a controlled environment to observe the processes triggered in the system. Tools like Process Monitor and Process Explorer are commonly used. To safely perform dynamic analysis, it’s crucial to use a virtual machine, ensuring the malware doesn’t cause real damage

- ### Interactive analysis

  Interactive analysis is a more advanced form of dynamic analysis, allowing researchers to control the malware’s execution and respond to it in real time. This method offers the most realistic simulation, letting analysts interact with pop-ups or modify OS configurations during the process. It’s particularly useful when dealing with sophisticated malware, like banking Trojans, which only activate under specific conditions.

  All these actions are difficult to implement using automated analysis tools.

---

<br>
<br>

# Stages of Malware Analysis

Malware analysis can be broken down into several stages. Sometimes, only a few steps are needed, but using all of them provides the most comprehensive understanding.

![stages](./img/stages.png)

- ### Reverse code Analysis

  This advanced stage involves reverse engineering the binary file to understand its workings. It requires specialized skills and tools like disassemblers and debuggers. While some might skip this step due to its complexity, it often reveals critical insights into the malware.

- ### Interactive Behavioral analysis

  The suspicious file is executed in a controlled lab environment to observe its behavior. Analysts monitor in real-time how the malware interacts with external hosts, launches processes, and creates tasks, providing a detailed log of the program’s activities.

- ### static property analysis

  This stage involves examining static properties like strings, encoded data fragments, or compiled code sequences. The goal is to find malicious patterns, which can later become indicators of compromise.

- ### fully automated analysis

  This method quickly identifies malware by using automated systems to detect its presence. Although it’s fast, the depth of analysis is limited compared to expert reviews.

### Lesson Summary

- Malware Analysis is the process of examining a malware sample.
- There are three main types: static, dynamic, and interactive.
- Malware analysis enables you to:
- investigate security incidents
- understand the malware’s mechanisms
- obtain Indicators of Compromise (IOC)

---

<br>
<br>

![test1](./img/test1.png)

## oops my bad for sucking at this !!

<br>
<br>

# Types of Malware

The object of Malware Analysis is malware. There are many options for what it can be, and the number of options is increasing every day. And IS industry specialists have a need to share knowledge/data, and work with reports and tools that target specific classes of malware. This requires a classification or naming system. In the lesson, we will consider two approaches: the historical naming of the malware and the classification that we believe reflects the current situation with the malware well. Let's go!

In This Lesson

- ### CARO naming scheme
- ### The most popular malware families and modern classification

---

<br>
<br>

# CARO Naming Scheme

Let's start with the CARO (Computer Antivirus Research Organization) naming system/schema for malware samples. It is simple, easy to understand and is the basis for many modern classifications.

So, the scheme is built as follows:

```
[<type>://][<platform>/]<family>[.<group>][.<length>].<variant>[<modifiers>][!<comment>]
```

| **Field**                         | **Description**                                                                                                                                           |
| --------------------------------- | --------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Malware type**                  | virus, dropper, trojan, dialer, backdoor, exploit, tool, garbage                                                                                          |
| **Platform**                      | ~~V97M - macro for Office 97, Win32 - Windows 32-bit executable subsystem~~<br>**Win64 - Windows 64-bit executable subsystem**                            |
| **A family with a specific name** | (Foo ...) or a specific class-family (HLLC - High Level Language Companion Virus, HLLO - High Level Language Overwriter Virus ...)                        |
| **Group**                         | a common short name for similar malware samples in a group, but distinct from others in a family                                                          |
| **Length**                        | contains a decimal number for the length of the viral body or infecting code (depending on the type of malware)                                           |
| **Variant**                       | an even narrower division (family and group are common, but there may be some minor differences in code, etc.)                                            |
| **Modifiers**                     | data for maximum specification of threat characteristics/attributes (locale/country: De, Ru), minor specification of functional features                  |
| **Comment**                       | everything that was not included in the previous parts of the name and can specify any details that are useful for classification, threat reporting, etc. |

lets see an example

```
//example
Email-Worm.Win32/Netsky.bc.25@MM!Packed
```

This scheme was published and used for some time by vendors, laboratories, and researchers, but it never became a unified standard for decades. Instead, individual IS companies, antivirus vendors, research laboratories, and individual experts/groups of experts began to use their own or other (borrowed) malware naming schemes, and there is still no single standard.

---

<br>
<br>

# Most Popular Malware Families and Modern Classification

Here we will present one of the variants of the modern threat naming and classification scheme. It no longer contains comments (in the name) or lengths for objective reasons.

For example:

Programs that infect executable files have practically disappeared. The lengths of the files themselves and the infecting code are also no longer significant characteristics (files range from a few hundred bytes to hundreds of megabytes or more). Also, malware has since grown to the point where there is simply no way to manually describe all the individual characteristics in naming.

Why?

- Old viruses used to change other files — modern malware doesn’t usually do that.
- Malware today can be tiny or huge, so file size isn’t a useful clue.
- There are too many new threats, so names need to be short and clear.

> [!NOTE]
>
> About 50% of modern malware are Trojans because they don’t need to infect files, reducing the chance of detection.  
> Trojans appear as legitimate software, making users more likely to run them.  
> They are easier to distribute via emails, fake downloads, or malicious websites.  
> Unlike viruses, Trojans avoid triggering antivirus by not modifying existing files.  
> Their versatility makes them ideal for spying, stealing data, or installing more malware.

It should be noted that about 50% of modern malware belongs to one or another subtype of Trojans. This is due to both the lack of the need to infect files (which would lead to an active triggering of defenses) and the convenience of their distribution and effectiveness.

![PE](./img/PE.png)

So, the main types of malware:

- ## virus

  Virus - classic file malware that most often infects other executable objects/programs. Virtually uncommon nowadays. Examples: older ones (Jerusalem, OneHalf). More modern (2000-2010/2015): Sality, Virut.

- ## Worms

  Worms - malicious programs that spread independently over computer networks. Most often they exploited various vulnerabilities in protocols, network services code, and other OS/network components for distribution. Examples: older ones (ILoveYou, MsBlast, Sasser). More modern (2000-2018): Conficker, WannaCry (is a hybrid of a worm and an encryption trojan).

- ## Rootkits and Bootkits

  Rootkits and Bootkits – malicious programs that in most cases have several purposes: by performing low-level access to the operating system, they intercept system calls and modify certain system structures in the operating system. Usually, this is done to hide the presence of other malware or to gain a low-level, hard-to-detect foothold in the system. Such programs are difficult to detect and even harder to remove from the system. Examples: TDL-TDL3 (classic rootkits), TDL-4 (classic bootkit), MosaicRegressor (UEFI bootkit), BlackLotus (UEFI bootkit).
